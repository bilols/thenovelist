{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://novelist.ai/schemas/outline.schema.v1.json",
  "title": "Novelist Story Outline (v1)",
  "type": "object",
  "required": ["header", "outlineProgress", "premise", "chapters"],
  "additionalProperties": false,

  "definitions": {
    "timestamp": { "type": "string", "format": "date-time" },
    "wordArray": {
      "type": "array",
      "items": { "type": "string", "minLength": 1 },
      "minItems": 1
    }
  },

  "properties": {
    "header": {
      "type": "object",
      "required": ["schemaVersion", "dateCreated"],
      "properties": {
        "schemaVersion": { "type": "integer", "minimum": 1 },
        "dateCreated":   { "$ref": "#/definitions/timestamp" },
        "projectFile":   { "type": "string" }
      },
      "additionalProperties": false
    },

    "outlineProgress": {
      "type": "string",
      "enum": [
        "Init",
        "PremiseExpanded",
        "ArcDefined",
        "CharactersOutlined",
        "ChaptersSketched",
        "BeatsDetailed",
        "Finalized"
      ]
    },

    "premise":     { "type": "string", "minLength": 150 },
    "famousAuthor":{ "type": ["object", "null"], "additionalProperties": true },

    "storyArc": {
      "description": "High‑level multi‑act structure",
      "type": "array",
      "items": {
        "type": "object",
        "required": ["act", "summary"],
        "properties": {
          "act":           { "type": "integer", "minimum": 1 },
          "summary":       { "type": "string", "minLength": 10 },
          "turningPoints": { "type": "array", "items": { "type": "string" } }
        },
        "additionalProperties": false
      }
    },

    "characters": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "role", "traits", "arc"],
        "properties": {
          "name":   { "type": "string" },
          "role":   { "type": "string" },
          "traits": { "$ref": "#/definitions/wordArray" },
          "arc":    { "type": "string" }
        },
        "additionalProperties": false
      }
    },

    "chapters": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["number", "summary", "beats"],
        "properties": {
          "number":     { "type": "integer" },
          "summary":    { "type": "string" },
          "beats":      { "type": "array", "items": { "type": "string" } },
          "themes":     { "type": "array", "items": { "type": "string" } },
          "wordBudget": { "type": "integer", "minimum": 1 }
        },
        "additionalProperties": false
      }
    }
  }
}
